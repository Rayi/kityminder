<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">

    <script src="lib/jquery-2.1.0.min.js" charset="utf-8"></script>

    <script src="kity/dist/kitygraph.all.js" charset="utf-8"></script>
    <script src="import.js" charset="utf-8"></script>
    <script src="kityminder.config.js" charset="utf-8"></script>
    <script src="lang/zh-cn/zh-cn.js" charset="utf-8"></script>
    
    <script src="lib/zip.js" charset="utf-8"></script>
    <script>
        zip.inflateJSPath = 'lib/inflate.js';
    </script>

    <script src="lib/jquery.xml2json.js" charset="utf-8"></script>
   
    <link href="themes/default/css/import.css" type="text/css" rel="stylesheet" />
    
    <link rel="stylesheet" href="pan/pan.css">
    <script src="pan/minder.third.js" charset="utf-8"></script>
</head>
<style>
</style>
<body>
    <div class="files">
        <a class="file" data-extension="xmind" data-url="https://c.pcs.baidu.com/rest/2.0/pcs/file?path=%2Fapps%2Fkityminder%2F%E7%99%BE%E5%BA%A6xmind-%E7%BD%91%E7%9B%98.xmind&access_token=52.a168cdef7648c17628a0695e40771fd7.2592000.1401277148.2936331757-2246711&method=download" href="javascript:;">XMind 格式</a>
        &nbsp;&nbsp;&nbsp;&nbsp;
        <a class="file" data-extension="km" data-url="https://c.pcs.baidu.com/rest/2.0/pcs/file?path=%2Fapps%2Fkityminder%2Fkm%E6%A0%BC%E5%BC%8F-%E7%BD%91%E7%9B%98.km&access_token=52.cadcb9ad33b982654c2d0cd641b33b54.2592000.1401332814.2936331757-2246711&method=download" href="javascript:;">KM 格式</a>
    </div>

    <div id="minder-container">
        
    </div>
</body>
<script>
    // create km instance

    function getContainerId(id){
        if( $('#'+id).length == 0 ){
            var container = $('<div id="' + id + '" class="container" onselectstart="return false"><div class="mask"></div><img class="loading" src="pan/loading.gif" /><div class="close">X</div></div>').prependTo(document.body);

            $('.close', container).click(function(){
                container.hide();
            });

            container.hide();
        }

        return id;
    }

    function enableLoading(container){
        $('.loading, .mask', container).show();
    }

    function disableLoading(container){
        $('.loading, .mask', container).hide();
    }

    $('.files').delegate('.file', 'click', function(){
        var url = $(this).attr('data-url');
        var extension = $(this).attr('data-extension');

        var id = getContainerId('minder');
        var container = $('#'+id).show();

        enableLoading(container);

        var minder = KM.renderByUrl(id, url, extension, function(minder){
            disableLoading(container);
        });

        minder.on('renderprogress', function() {
            
        });
    });
    
    getContainerId('minder');
</script>
</html>